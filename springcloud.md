
## 分布式
cap
- 一致性，可用性，分区容错性
- zookeeper cp
- eureka ap
- nacos 默认ap可设置cp

springcloud和dubbo
- springcloud是微服务架构下一站式解决方案
- dubbo是rpc分布式服务框架，主要服务调用和治理

注册中心 nacos
- 服务发现：向注册中心注册自己的服务名ip 端口以及其他信息，使注册中心知道实例信息
- 配置管理：将模块的配置在nacos实例，将配置集中在nacos管理
- 服务治理

网关的作用 gatwey
- 路由功能：和注册中心搭配实现微服务发现，只要知道网关对外的地址就可以调用到具体服务
- 统一鉴权：身份验证模块抽取到网关层，不需要每个模块都进行验证
- 负载均衡：结合网关实现下游地址的负载均衡
- 指标监控：统计后台请求次数，实时更新当前的流量健康状态
- 限流熔断：可以配置一个阈值，超过阈值可以直接返回错误不进行后台的请求，防止流量洪峰导致后台宕机
- 黑白名单：过滤特殊请求，防止ddos攻击，在网关层面进行拦截。白名单可跳过权限验证
- 协议转换：通过网关整合后台不同风格请求，例如rest，amqp，rpc
- 文档中心：结合swagger，统一提供开放后台接口文档
- 日志收集：统一的日志记录和收集器

分布式事务
- 2pc、3pc：强一致性的，事务执行过程中锁定所有需要执行的资源，适合执行时间比较短的事务，性能比较差。刚性事务
 - tcc：基于业务层，不存在阻塞行为，每个资源都进行提交，如果失败再使用cancel进行回滚。补偿性事务。对业务的侵入性很强，不能很好的被复用

消息事务seata
seata：角色有tc全局事务协调者，tm事务管理者，rm资源管理者
- tc：用来协调全局事务和各个分支事务，驱动事务的提交和回滚
- tm：业务层中的提交和回滚
- rm：与tc进行协调注册分支事务和汇报事务的状态，驱动提交和回滚
- 而且设置了一个undo_log表，负责将业务数据更新前后的数据镜像组织成日志备份再undo_log中，以便随时回滚

sentinel
- 熔断器是一种容错机制，主要用于微服务架构对服务的保护，防止单一服务宕机导致的请求阻塞引起的服务雪崩
- 默认使用滑动窗口算法
 - 实时监控，限流，熔断，服务熔断，热点key限流
 - 规则
   - 流量控制规则，熔断降级规则，系统保护规则，来源访问控制规则，热点参数规则

负载均衡rabbin
 - 客户端负载均衡，主要是各个服务之间实现负载均衡
 - 使用feign或者配合restTemplate方式实现

feign和dubbo
- 都专注与远程调用
- dubbo是rpc分布式框架
- feign是组件，主要面向服务调用
- feign通过restapi实现远程调用，dubbo是通过rpc实现的远程调用
- feign基于http传输协议服务粒度是接口级，dubbo基于netty、tcp传输服务粒度是方法级
