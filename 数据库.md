## 数据库
### 数据库优化和分库分表
#### 优化考虑顺序
	字段冗余-sql优化-引入redis-硬件优化-分库-分表-同一模块分库
- 数据库设计时可以考虑字段冗余，简单的纵向分表。冗余字段和操作少的字段放入详情表
- 首先考虑sql优化，代价小，收益高
- 硬件优化对于刚开始效果比较明显
- 分库分表
#### 为了防止数据库性能不够不同模块使用不同的数据库
##### 横向分表和纵向分表
- 纵向分表是操作较少的字段放入副表
- 横向分表是根据不同的类型的字段分别放入不同的表，每月，每年，类型 只要能有区别都可以分表
- 同一模块使用多个数据库
- 同一模块使用不同的数据库和不同的表
- 为了减少单张表大小，解决单张表数据过大带来的性能问题
##### 需要考虑
- 分库分表带来的复杂性比较高多数据库关联查询，分布式事务，分布式id，多数据源
### sql优化
#### 分页
- 大量数据在同一个表中可以多使用主键，使用主键是最快的（涉及了主键索引和回表）
- 延迟关联 使用子查询将查出分页需要的id，用id作为关联条件查询
- 书签 用max或者min得到符合要求的最大或最小id，使用id判断大小进行判断
- id自增可以使用between and 分页进行优化
- 多表关联可以使用查到关联表存的关联id，然后使用in拼接id进行查询

### mysql集群
- 单一主从复制：主库负责写从库负责读，从库写入数据存在时间上的延迟，对主库和从库的网络要求高，主节点挂掉无法写入
- 织物：有选举机制，缺点上面一样，节点故障恢复时间较长
- 多主多从结构：高可用，负载均衡，没有单点故障问题，架构模式复杂，只能使用ndb引擎
